<!DOCTYPE html>
<html>
<head>
    <meta charset='utf-8' />
    <title>Music mapmadness18</title>
    <meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />
    <script src='https://api.tiles.mapbox.com/mapbox-gl-js/v0.44.1/mapbox-gl.js'></script>
    <link href='https://api.tiles.mapbox.com/mapbox-gl-js/v0.44.1/mapbox-gl.css' rel='stylesheet' />
    <style>
        body { margin:0; padding:0; }
        #map { position:absolute; top:0; bottom:0; width:100%; }
    </style>
</head>
<body>

<style>
    .mapboxgl-popup {
      position: absolute;
        width: 330px;
        border-radius: 6px;
        padding: 5px 10px 0px 5px;
        font: 12px/20px 'Helvetica Neue', Arial, Helvetica, sans-serif;
    }
    .audio {
      position: relative;
      padding: 10px;
    }

    iframe{
      position: relative;
      padding: 10px;
    }

    strong {
      padding-left: 10px;
      color: #4688F1;
    }

    p {
      padding-left: 10px;
      color: #5A5A5A;
    }

</style>
<div id='map'></div>
<script>

mapboxgl.accessToken = "pk.eyJ1IjoibGVuYWVtYXlhIiwiYSI6ImNpa3VhbXE5ZjAwMXB3eG00ajVyc2J6ZTIifQ.kmZ4yVcNrupl4H8EonM3aQ";


var map = new mapboxgl.Map({
  container: "map",
  style: "mapbox://styles/lenaemaya/cjey8ks7w404q2qpezuwj65s8",
  center: [9.663612,35.129999],
zoom: 1
});


map.on('load', function () {
    // Add a layer showing the places.
    map.addLayer({
        "id": "places",
        "type": "symbol",
        "source": {
            "type": "geojson",
            "data": {
                "type": "FeatureCollection",
                "features": [{
                    "type": "Feature",
                    "properties": {
                        "description": '<audio class="audio" src="New_York.mp3" controls>	<embed src="/music/good_enough.mp3" loop="false" autostart="false"></audio><p></p><strong>Frank Sinatra</strong><p>New York</p>',
                        "name": "New York"
                    },
                    "geometry": {
                        "type": "Point",
                        "coordinates": [-73.992919921875,40.72228267283148]
                    }
                },{
                    "type": "Feature",
                    "properties": {
                        "description": '<audio class="audio" src="Panic In Detroit.mp3" controls>	<embed src="/music/good_enough.mp3" loop="false" autostart="false"></audio><p></p><strong>David Bowie</strong><p>Panic In Detroit</p>',
                        "name": "Detroit"
                    },
                    "geometry": {
                        "type": "Point",
                        "coordinates": [-83.056640625,42.35042512243457]
                    }
                }, {
                    "type": "Feature",
                    "properties": {
                        "description": '<audio class="audio" src="Sweet Home Chicago.mp3" controls>	<embed src="/music/good_enough.mp3" loop="false" autostart="false"></audio><p></p><strong>The Blues Brothers</strong><p>Sweet Home Chicago</p>',
                        "name": "Chicago"
                    },
                    "geometry": {
                        "type": "Point",
                        "coordinates": [-87.62695312499999,41.87774145109676]
                    }
                }, {
                    "type": "Feature",
                    "properties": {
                        "description": '<audio src="San_Francisco.mp3" controls>	<embed src="/music/good_enough.mp3" loop="false" autostart="false"></audio><p></p><strong>Scott McKenzie</strong><p>San Francisco</p>',
                        "name": "San Francisco"
                    },
                    "geometry": {
                        "type": "Point",
                        "coordinates": [-122.431640625,37.77071473849609]
                    }},
                // }, {
                //     "type": "Feature",
                //     "properties": {
                //         "description":  '<audio src="another_day.mp3" controls>	<embed src="/music/good_enough.mp3" width="50" height="50" loop="false" autostart="false"></audio>',
                //         "name": "Santa Fe"
                //     },
                //     "geometry": {
                //         "type": "Point",
                //         "coordinates": [-118.06809425354004,33.947916898356404]
                //     }
                // }, {
                    {
                    "type": "Feature",
                    "properties": {
                        "description": '<audio src="Rising_Sun.mp3" controls> <embed src="/music/good_enough.mp3" loop="false" autostart="false"></audio><p></p><strong>The Animals</strong><p>The House of the Rising Sun</p>',
                        "name": "New Orleans"
                    },
                    "geometry": {
                        "type": "Point",
                        "coordinates": [-90.087890625,29.935895213372444]
                    }
                }, {
                    "type": "Feature",
                    "properties": {
                        "description": '<audio src="Pasadena.mp3" controls>	<embed src="/music/good_enough.mp3" loop="false" autostart="false"></audio><p></p><strong>Maywood</strong><p>Pasadena</p>',
                        "name": "Pasadena"
                    },
                    "geometry": {
                        "type": "Point",
                        "coordinates": [-118.14525604248045,34.14619208917145]
                    }
                }, {
                    "type": "Feature",
                    "properties": {
                        "description": '<iframe width="300" height="170" src="https://www.youtube.com/embed/NvS351QKFV4?rel=0" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen color="white"></iframe><p></p><strong>Dschinghis Khan</strong><p>Moskau</p>',
                        "name": "Moscow"
                    },
                    "geometry": {
                        "type": "Point",
                        "coordinates": [37.617037296295166,55.751305971950934]
                    }
                }
              ]
            }
        },
        "layout": {
          "icon-image": "music-15",
          "icon-size": {
            "base": 1,
            "stops": [[0, 0.7], [22, 1.3]]
          },
          "text-field": "{name}",
          "text-anchor": "top",
          "text-offset": {
            "base": 1,
            "stops": [
              [0, [0, 1]],
              [22, [0, 0.3]]
              ]
            },
          "text-font": ["Arial Unicode MS Bold"],
          "text-size": {
            "base": 1.25,
            "stops": [[4, 12], [13, 35]]
          }},
        "paint": {
            "text-color": "#7FEBFD",
            "text-halo-color": "#302AA6",
            "text-halo-width": 1,
            "text-halo-blur": 2
          }
        })
    });


      map.on('click', 'places', function (e) {
          var coordinates = e.features[0].geometry.coordinates.slice();
          var description = e.features[0].properties.description;

          map.flyTo({center: e.features[0].geometry.coordinates, zoom: 15, pitch: 60} );

          while (Math.abs(e.lngLat.lng - coordinates[0]) > 180) {
              coordinates[0] += e.lngLat.lng > coordinates[0] ? 360 : -360;
          }

          new mapboxgl.Popup()
              .setLngLat(coordinates)

              .setHTML(description)

              .addTo(map);
      });

      map.on('mouseenter', 'places', function () {
          map.getCanvas().style.cursor = 'pointer';
      });


      map.on('mouseleave', 'places', function () {
          map.getCanvas().style.cursor = '';
      });



</script>

</body>
</html>
